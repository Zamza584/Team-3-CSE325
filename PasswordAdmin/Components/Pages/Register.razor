@page "/register"
@rendermode InteractiveServer
@using PasswordAdmin.Models

@inject NavigationManager Nav

<h1>Register Page</h1>
<p>Create a new account.</p>

@if (ErrorMessage is not null)
{
    <p style="color:#b00020; font-weight:600;">‚ùå @ErrorMessage</p>
}

<form method="post" action="/account/register" style="max-width:420px;">
    <AntiforgeryToken />

    <div style="margin-bottom:12px;">
        <label>Email</label>
        <input name="email" class="form-control" />
    </div>

    <div style="margin-bottom:12px;">
        <label for="password">Password</label>
        <input name="password" type="@dp1.getType()" class="form-control" id="password" />
        <div class="eye-logo" @onclick="@dp1.ShowPassword"><img src="@dp1.getEyeSrc()" alt="@dp1.getEyeAlt()"></div>
    </div>

    <div style="margin-bottom:12px;">
        <label for="confirmPassword">Confirm Password</label>
        <input name="confirmPassword" type="@dp2.getType()" class="form-control" id="confirmPassword" />
        <div class="eye-logo" @onclick="@dp2.ShowPassword"><img src="@dp2.getEyeSrc()" alt="@dp2.getEyeAlt()"></div>
    </div>

    <button type="submit">Create account</button>
</form>

@code {

    @* Display password class is found in models folder. *@
    DisplayPassword dp1 = new DisplayPassword();
    DisplayPassword dp2 = new DisplayPassword();

    private string? ErrorMessage
    {
        get
        {
            var q = Nav.ToAbsoluteUri(Nav.Uri).Query;
            if (q.Contains("error=pwdmatch")) return "Passwords do not match.";
            if (q.Contains("error=1")) return "Could not create the user (email may already exist or password rules).";
            return null;
        }
    }
}